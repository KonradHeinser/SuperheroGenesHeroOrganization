<?xml version="1.0" encoding="utf-8" ?>
<Defs>
    <ThingDef ParentName="BuildingBase">
        <defName>SHG_VillainDevice</defName>
        <label>villain device</label>
        <description>An ultratech weapon of mass destruction repurposed to work in a network that will blanket the planet in a lethal gas. If a planet has enough of them they can all be activated at the same time to begin the somewhat lengthy process of blanketing the world, but this network will be broken if the main one is destroyed.</description>   
        <graphicData>
            <texPath>Things/Building/Misc/SmokeSpewer</texPath>
            <graphicClass>Graphic_Single</graphicClass>
            <drawSize>(8,8)</drawSize>
            <shadowData>
                <volume>(4.5,3.5,4.4)</volume>
                <offset>(0,0,0)</offset>
            </shadowData>
            <damageData>
                <rect>(0.1, 0.8, 5.8, 3.9)</rect>
            </damageData>
        </graphicData> 
        <altitudeLayer>Building</altitudeLayer>
        <pathCost>50</pathCost>
        <blockWind>true</blockWind>
        <passability>Impassable</passability>
        <canOverlapZones>false</canOverlapZones>
        <fillPercent>1.0</fillPercent>
        <statBases>
          <MaxHitPoints>1000</MaxHitPoints>
          <Flammability>0</Flammability>
        </statBases>
        <damageMultipliers>
          <li>
            <damageDef>Flame</damageDef>
            <multiplier>0</multiplier>
          </li>
        </damageMultipliers>
        <building>
          <claimable>false</claimable>
          <destroySound>BuildingDestroyed_Metal_Big</destroySound>
        </building>
        <rotatable>false</rotatable>
        <selectable>true</selectable>
        <terrainAffordanceNeeded>Light</terrainAffordanceNeeded>
        <soundImpactDefault>BulletImpact_Metal</soundImpactDefault>
        <drawerType>MapMeshOnly</drawerType>
        <castEdgeShadows>True</castEdgeShadows>
        <repairEffect>ConstructMetal</repairEffect>
        <forceDebugSpawnable>true</forceDebugSpawnable>
        <killedLeavings>
          <Steel>60</Steel>
          <ComponentIndustrial>1</ComponentIndustrial>
          <Plasteel>10</Plasteel>
          <ChunkSlagSteel>4</ChunkSlagSteel>
        </killedLeavings>    
    </ThingDef>

    <HistoryEventDef>
      <defName>SHGHero_StopTheLeague</defName>
      <label>stopped The League's villainous plan</label>
    </HistoryEventDef>
  
    <QuestScriptDef>
      <defName>SHGHero_EndGame_StopTheLeague</defName>
      <rootSelectionWeight>0</rootSelectionWeight>
      <isRootSpecial>true</isRootSpecial>
      <rootMinPoints>300</rootMinPoints>
      <defaultChallengeRating>5</defaultChallengeRating>
      <epic>true</epic>
      <successHistoryEvent>SHGHero_StopTheLeague</successHistoryEvent>
      <questNameRules>
        <rulesStrings> 
          <li>questName->Stop the League of Villains</li>
        </rulesStrings>
      </questNameRules>
      <questDescriptionRules>
        <rulesStrings>
          <li>questDescription->The villains appear to be planning something that may kill a large number of people!</li>
          <li>questDescriptionPartBeforeDiscovery->First you'll need to destroy some of the nearby devices that are making it hard to pinpoint which one is the central point of the network.</li>
        </rulesStrings>
      </questDescriptionRules>
      <root Class="QuestNode_Sequence">
        <nodes>
          <li Class="SuperHeroGenesBase.QuestNode_Root_StopTheLeague">
            <villainousDevices>
              <li>SHG_VillainDevice</li>
            </villainousDevices>
            <faction>SuperVillainGang</faction>
            <sitePartDef>SHGHero_VillainComplex</sitePartDef>
            <ticksBetweenSubquests>60000~120000</ticksBetweenSubquests> <!--Defaults to 1~2 days-->
            <totalSubquests>3</totalSubquests> <!--The number of devices that need to be destroyed before the main one becomes available-->
          </li>
          <!--Need end game when quest success, plus giving ever evolving hediffs. Hediff that gradually increases ever-evolving hediffs?-->
        </nodes>
      </root>
    </QuestScriptDef>
  
    <QuestScriptDef>
        <defName>SHGHero_DestroyVillainousDevice</defName>
        <rootSelectionWeight>0</rootSelectionWeight>
        <defaultChallengeRating>3</defaultChallengeRating>
        <isRootSpecial>true</isRootSpecial>
        <epicParent>SHGHero_EndGame_StopTheLeague</epicParent>
        <questNameRules>
            <rulesStrings>
                <li>questName->Destroy Villainous Device</li>
            </rulesStrings>
        </questNameRules>
        <questDescriptionRules>
            <rulesStrings>
                
                <!-- description -->
                <li>questDescription->You've learned of a villain complex nearby that contains a doomsday device. This device is probably .\n\nWatch out - there may be all manner of dangers inside, and other enemies may also be attracted by activity at the structure.</li>
            </rulesStrings>
        </questDescriptionRules>
        <questContentRules>
            <rulesStrings>
                <!-- Misc -->
                <li>terminalHackedMessage->Terminal hacked. {COUNT} / [terminalCount] complete.</li>
                <li>allTerminalsHackedMessage->You can now leave.</li>
            </rulesStrings>
        </questContentRules>
        <root Class="QuestNode_Root_Hack_AncientComplex" />
        <!--Needs reworked completely for obvious reasons-->
    </QuestScriptDef>
</Defs>

<!-- 
Becoming enemies with The Hero Organization will NOT cause a quest failure, but the player must be allies to receive the quest in the first place
Use QuestNode_ChangeFactionGoodwill on The Organization and The League at each stage to ensure ally/enemy status?
    Allows for player trickery between stages, but intentions become clear after each stage
    Would need to be in the subquests
Needs custom site stuff for each part
  See the AncientComplex ComplexLayoutDef for an idea
    Will need a ComplexThreatDef
-->
